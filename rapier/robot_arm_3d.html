<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>3D Robot Arm Programming Studio</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700;900&family=Rajdhani:wght@300;400;600&display=swap');

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Rajdhani', sans-serif;
            background: linear-gradient(135deg, #0f0c29, #302b63, #24243e);
            color: #fff;
            overflow-x: hidden;
        }

        .container {
            display: grid;
            grid-template-columns: 1fr 400px;
            height: 100vh;
            gap: 0;
        }

        .viewport-section {
            position: relative;
            background: radial-gradient(ellipse at top, #1a1a2e 0%, #0f0f1e 100%);
            overflow: hidden;
        }

        #canvas3d {
            width: 100%;
            height: 100%;
            display: block;
            cursor: grab;
        }

        #canvas3d:active {
            cursor: grabbing;
        }

        .viewport-overlay {
            position: absolute;
            top: 20px;
            left: 20px;
            background: rgba(15, 15, 30, 0.85);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(0, 255, 255, 0.3);
            border-radius: 12px;
            padding: 20px;
            font-family: 'Orbitron', monospace;
            box-shadow: 0 8px 32px rgba(0, 255, 255, 0.2);
        }

        .viewport-overlay h2 {
            color: #00ffff;
            font-size: 1.4em;
            margin-bottom: 15px;
            text-transform: uppercase;
            letter-spacing: 2px;
            font-weight: 900;
        }

        .status-grid {
            display: grid;
            gap: 8px;
        }

        .status-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 8px 12px;
            background: rgba(0, 255, 255, 0.05);
            border-left: 3px solid #00ffff;
            border-radius: 4px;
        }

        .status-label {
            color: #888;
            font-size: 0.9em;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .status-value {
            color: #00ffff;
            font-weight: 700;
            font-size: 1.1em;
        }

        .controls-panel {
            background: #0a0a15;
            border-left: 2px solid rgba(0, 255, 255, 0.3);
            overflow-y: auto;
            padding: 30px 25px;
        }

        .panel-header {
            text-align: center;
            margin-bottom: 30px;
            padding-bottom: 20px;
            border-bottom: 2px solid rgba(0, 255, 255, 0.3);
        }

        .panel-header h1 {
            font-family: 'Orbitron', monospace;
            font-size: 1.8em;
            color: #00ffff;
            text-transform: uppercase;
            letter-spacing: 3px;
            font-weight: 900;
            margin-bottom: 8px;
            text-shadow: 0 0 20px rgba(0, 255, 255, 0.5);
        }

        .panel-header p {
            color: #888;
            font-size: 0.9em;
            letter-spacing: 1px;
        }

        .control-section {
            background: rgba(15, 15, 30, 0.6);
            border: 1px solid rgba(0, 255, 255, 0.2);
            border-radius: 12px;
            padding: 20px;
            margin-bottom: 20px;
            transition: all 0.3s ease;
        }

        .control-section:hover {
            border-color: rgba(0, 255, 255, 0.5);
            box-shadow: 0 0 20px rgba(0, 255, 255, 0.1);
        }

        .control-section h3 {
            color: #00ffff;
            font-family: 'Orbitron', monospace;
            font-size: 1.1em;
            margin-bottom: 18px;
            text-transform: uppercase;
            letter-spacing: 2px;
            font-weight: 700;
        }

        .slider-group {
            margin-bottom: 20px;
        }

        .slider-label {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 10px;
            font-size: 0.95em;
        }

        .slider-name {
            color: #aaa;
            text-transform: uppercase;
            letter-spacing: 1px;
            font-size: 0.85em;
        }

        .slider-value {
            background: rgba(0, 255, 255, 0.2);
            color: #00ffff;
            padding: 4px 12px;
            border-radius: 4px;
            font-weight: 700;
            font-family: 'Orbitron', monospace;
            min-width: 60px;
            text-align: center;
        }

        input[type="range"] {
            width: 100%;
            height: 6px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 3px;
            outline: none;
            -webkit-appearance: none;
            position: relative;
        }

        input[type="range"]::-webkit-slider-thumb {
            -webkit-appearance: none;
            appearance: none;
            width: 18px;
            height: 18px;
            background: #00ffff;
            cursor: pointer;
            border-radius: 50%;
            box-shadow: 0 0 10px rgba(0, 255, 255, 0.7);
            transition: all 0.2s ease;
        }

        input[type="range"]::-webkit-slider-thumb:hover {
            width: 22px;
            height: 22px;
            box-shadow: 0 0 20px rgba(0, 255, 255, 1);
        }

        input[type="range"]::-moz-range-thumb {
            width: 18px;
            height: 18px;
            background: #00ffff;
            cursor: pointer;
            border-radius: 50%;
            border: none;
            box-shadow: 0 0 10px rgba(0, 255, 255, 0.7);
        }

        .button-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 10px;
            margin-top: 15px;
        }

        button {
            background: linear-gradient(135deg, rgba(0, 255, 255, 0.2), rgba(0, 150, 255, 0.2));
            color: #00ffff;
            border: 1px solid rgba(0, 255, 255, 0.5);
            padding: 12px 16px;
            border-radius: 8px;
            cursor: pointer;
            font-family: 'Orbitron', monospace;
            font-size: 0.85em;
            font-weight: 700;
            text-transform: uppercase;
            letter-spacing: 1px;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }

        button::before {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            width: 0;
            height: 0;
            background: rgba(0, 255, 255, 0.3);
            border-radius: 50%;
            transform: translate(-50%, -50%);
            transition: width 0.6s, height 0.6s;
        }

        button:hover::before {
            width: 300px;
            height: 300px;
        }

        button:hover {
            border-color: #00ffff;
            box-shadow: 0 0 20px rgba(0, 255, 255, 0.4);
            transform: translateY(-2px);
        }

        button:active {
            transform: translateY(0);
        }

        button span {
            position: relative;
            z-index: 1;
        }

        button.full-width {
            grid-column: 1 / -1;
        }

        button.danger {
            background: linear-gradient(135deg, rgba(255, 0, 100, 0.2), rgba(200, 0, 50, 0.2));
            color: #ff0066;
            border-color: rgba(255, 0, 100, 0.5);
        }

        button.danger:hover {
            border-color: #ff0066;
            box-shadow: 0 0 20px rgba(255, 0, 100, 0.4);
        }

        button.success {
            background: linear-gradient(135deg, rgba(0, 255, 150, 0.2), rgba(0, 200, 100, 0.2));
            color: #00ff88;
            border-color: rgba(0, 255, 150, 0.5);
        }

        button.success:hover {
            border-color: #00ff88;
            box-shadow: 0 0 20px rgba(0, 255, 150, 0.4);
        }

        .console {
            background: rgba(0, 0, 0, 0.6);
            border: 1px solid rgba(0, 255, 255, 0.3);
            border-radius: 8px;
            padding: 15px;
            height: 180px;
            overflow-y: auto;
            font-family: 'Courier New', monospace;
            font-size: 0.85em;
            line-height: 1.6;
            margin-top: 15px;
        }

        .console-line {
            color: #0f0;
            margin-bottom: 4px;
        }

        .console-line.info {
            color: #00ffff;
        }

        .console-line.warning {
            color: #ffaa00;
        }

        .console-line.error {
            color: #ff0066;
        }

        .console::-webkit-scrollbar {
            width: 8px;
        }

        .console::-webkit-scrollbar-track {
            background: rgba(0, 0, 0, 0.3);
            border-radius: 4px;
        }

        .console::-webkit-scrollbar-thumb {
            background: rgba(0, 255, 255, 0.3);
            border-radius: 4px;
        }

        .console::-webkit-scrollbar-thumb:hover {
            background: rgba(0, 255, 255, 0.5);
        }

        .info-badge {
            background: rgba(0, 255, 255, 0.1);
            border-left: 3px solid #00ffff;
            padding: 15px;
            border-radius: 6px;
            margin: 15px 0;
            font-size: 0.9em;
            line-height: 1.6;
        }

        .info-badge strong {
            color: #00ffff;
            display: block;
            margin-bottom: 8px;
            font-family: 'Orbitron', monospace;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .controls-panel::-webkit-scrollbar {
            width: 10px;
        }

        .controls-panel::-webkit-scrollbar-track {
            background: #0a0a15;
        }

        .controls-panel::-webkit-scrollbar-thumb {
            background: rgba(0, 255, 255, 0.3);
            border-radius: 5px;
        }

        @keyframes glow {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.5; }
        }

        .glow {
            animation: glow 2s ease-in-out infinite;
        }

        @media (max-width: 1024px) {
            .container {
                grid-template-columns: 1fr;
                grid-template-rows: 60vh auto;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="viewport-section">
            <canvas id="canvas3d"></canvas>
            
            <div class="viewport-overlay">
                <h2>SYSTEM STATUS</h2>
                <div class="status-grid">
                    <div class="status-item">
                        <span class="status-label">Base</span>
                        <span class="status-value" id="display-joint1">0¬∞</span>
                    </div>
                    <div class="status-item">
                        <span class="status-label">Shoulder</span>
                        <span class="status-value" id="display-joint2">0¬∞</span>
                    </div>
                    <div class="status-item">
                        <span class="status-label">Elbow</span>
                        <span class="status-value" id="display-joint3">0¬∞</span>
                    </div>
                    <div class="status-item">
                        <span class="status-label">Gripper</span>
                        <span class="status-value glow" id="display-gripper">OPEN</span>
                    </div>
                </div>
            </div>
        </div>

        <div class="controls-panel">
            <div class="panel-header">
                <h1>ROBO-ARM 3D</h1>
                <p>Advanced Control Interface</p>
            </div>

            <div class="control-section">
                <h3>üéÆ Manual Control</h3>
                
                <div class="slider-group">
                    <div class="slider-label">
                        <span class="slider-name">Joint 1 - Base</span>
                        <span class="slider-value" id="value-joint1">0¬∞</span>
                    </div>
                    <input type="range" id="joint1" min="-180" max="180" value="0" step="1">
                </div>

                <div class="slider-group">
                    <div class="slider-label">
                        <span class="slider-name">Joint 2 - Shoulder</span>
                        <span class="slider-value" id="value-joint2">0¬∞</span>
                    </div>
                    <input type="range" id="joint2" min="-90" max="90" value="0" step="1">
                </div>

                <div class="slider-group">
                    <div class="slider-label">
                        <span class="slider-name">Joint 3 - Elbow</span>
                        <span class="slider-value" id="value-joint3">0¬∞</span>
                    </div>
                    <input type="range" id="joint3" min="-120" max="120" value="0" step="1">
                </div>

                <div class="button-grid">
                    <button onclick="toggleGripper()"><span>ü§è GRIPPER</span></button>
                    <button class="danger" onclick="resetArm()"><span>üîÑ RESET</span></button>
                </div>
            </div>

            <div class="control-section">
                <h3>‚ö° Auto Sequences</h3>
                
                <div class="button-grid">
                    <button class="success" onclick="demoSequence()"><span>üéØ DEMO</span></button>
                    <button class="success" onclick="pickAndPlace()"><span>üì¶ PICK</span></button>
                    <button class="success" onclick="waveSequence()"><span>üëã WAVE</span></button>
                    <button class="success" onclick="scanSequence()"><span>üîç SCAN</span></button>
                </div>

                <div class="info-badge">
                    <strong>üí° Pro Tip</strong>
                    Drag to rotate the camera. Scroll to zoom. Watch the robot respond to your commands in real-time 3D!
                </div>
            </div>

            <div class="control-section">
                <h3>üìä Console Output</h3>
                <div class="console" id="console">
                    <div class="console-line info">[SYSTEM] Initializing 3D workspace...</div>
                    <div class="console-line info">[SYSTEM] Robot arm ready</div>
                </div>
                <div class="button-grid">
                    <button onclick="clearConsole()" class="full-width"><span>CLEAR LOG</span></button>
                </div>
            </div>

            <div class="control-section">
                <h3>üìö Learning Resources</h3>
                <div class="info-badge">
                    <strong>Key Concepts</strong>
                    ‚Ä¢ Forward Kinematics: Calculate end position from joint angles<br>
                    ‚Ä¢ Inverse Kinematics: Calculate joint angles from desired position<br>
                    ‚Ä¢ Degrees of Freedom: Number of independent movements<br>
                    ‚Ä¢ Work Envelope: Reachable space of the robot
                </div>
            </div>
        </div>
    </div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
    <script>
        // Three.js scene setup
        let scene, camera, renderer, robotArm;
        let base, shoulder, elbow, gripper, gripperLeft, gripperRight;
        let targetCube;
        let isAnimating = false;

        // Robot state
        const armState = {
            joint1: 0,
            joint2: 0,
            joint3: 0,
            gripperOpen: true
        };

        function init3D() {
            // Scene
            scene = new THREE.Scene();
            scene.background = new THREE.Color(0x0a0a15);
            scene.fog = new THREE.Fog(0x0a0a15, 10, 50);

            // Camera
            camera = new THREE.PerspectiveCamera(45, window.innerWidth / window.innerHeight, 0.1, 1000);
            camera.position.set(8, 6, 10);
            camera.lookAt(0, 2, 0);

            // Renderer
            const canvas = document.getElementById('canvas3d');
            renderer = new THREE.WebGLRenderer({ canvas, antialias: true });
            renderer.setSize(canvas.clientWidth, canvas.clientHeight);
            renderer.shadowMap.enabled = true;
            renderer.shadowMap.type = THREE.PCFSoftShadowMap;

            // Lights
            const ambientLight = new THREE.AmbientLight(0x404040, 1.5);
            scene.add(ambientLight);

            const directionalLight = new THREE.DirectionalLight(0x00ffff, 0.8);
            directionalLight.position.set(5, 10, 5);
            directionalLight.castShadow = true;
            directionalLight.shadow.mapSize.width = 2048;
            directionalLight.shadow.mapSize.height = 2048;
            scene.add(directionalLight);

            const pointLight = new THREE.PointLight(0xff00ff, 0.5, 50);
            pointLight.position.set(-5, 5, -5);
            scene.add(pointLight);

            // Grid floor
            const gridHelper = new THREE.GridHelper(20, 20, 0x00ffff, 0x222233);
            gridHelper.material.opacity = 0.3;
            gridHelper.material.transparent = true;
            scene.add(gridHelper);

            // Ground plane
            const groundGeometry = new THREE.PlaneGeometry(20, 20);
            const groundMaterial = new THREE.MeshStandardMaterial({ 
                color: 0x1a1a2e,
                roughness: 0.8,
                metalness: 0.2
            });
            const ground = new THREE.Mesh(groundGeometry, groundMaterial);
            ground.rotation.x = -Math.PI / 2;
            ground.receiveShadow = true;
            scene.add(ground);

            // Build robot arm
            buildRobotArm();

            // Add target cube
            const cubeGeometry = new THREE.BoxGeometry(0.5, 0.5, 0.5);
            const cubeMaterial = new THREE.MeshStandardMaterial({ 
                color: 0xff0066,
                emissive: 0xff0066,
                emissiveIntensity: 0.3,
                roughness: 0.3,
                metalness: 0.7
            });
            targetCube = new THREE.Mesh(cubeGeometry, cubeMaterial);
            targetCube.position.set(3, 0.25, 2);
            targetCube.castShadow = true;
            scene.add(targetCube);

            // Mouse controls for camera
            let isDragging = false;
            let previousMousePosition = { x: 0, y: 0 };
            let cameraAngle = 0;
            let cameraHeight = 6;

            canvas.addEventListener('mousedown', (e) => {
                isDragging = true;
                previousMousePosition = { x: e.clientX, y: e.clientY };
            });

            canvas.addEventListener('mousemove', (e) => {
                if (isDragging) {
                    const deltaX = e.clientX - previousMousePosition.x;
                    const deltaY = e.clientY - previousMousePosition.y;
                    
                    cameraAngle -= deltaX * 0.005;
                    cameraHeight = Math.max(2, Math.min(12, cameraHeight - deltaY * 0.02));
                    
                    const radius = 12;
                    camera.position.x = Math.sin(cameraAngle) * radius;
                    camera.position.z = Math.cos(cameraAngle) * radius;
                    camera.position.y = cameraHeight;
                    camera.lookAt(0, 2, 0);
                    
                    previousMousePosition = { x: e.clientX, y: e.clientY };
                }
            });

            canvas.addEventListener('mouseup', () => {
                isDragging = false;
            });

            canvas.addEventListener('wheel', (e) => {
                e.preventDefault();
                const zoomSpeed = 0.1;
                const radius = Math.sqrt(camera.position.x ** 2 + camera.position.z ** 2);
                const newRadius = Math.max(5, Math.min(20, radius + e.deltaY * zoomSpeed));
                const scale = newRadius / radius;
                camera.position.x *= scale;
                camera.position.z *= scale;
            });

            // Animation loop
            animate();

            log('[SYSTEM] 3D environment initialized', 'info');
        }

        function buildRobotArm() {
            robotArm = new THREE.Group();

            // Base
            const baseGeometry = new THREE.CylinderGeometry(0.8, 1, 0.3, 32);
            const baseMaterial = new THREE.MeshStandardMaterial({ 
                color: 0x444455,
                roughness: 0.5,
                metalness: 0.8
            });
            base = new THREE.Mesh(baseGeometry, baseMaterial);
            base.position.y = 0.15;
            base.castShadow = true;
            robotArm.add(base);

            // Shoulder joint and arm
            shoulder = new THREE.Group();
            shoulder.position.y = 0.3;
            
            const shoulderJointGeometry = new THREE.SphereGeometry(0.3, 32, 32);
            const jointMaterial = new THREE.MeshStandardMaterial({ 
                color: 0xff6600,
                emissive: 0xff6600,
                emissiveIntensity: 0.2,
                roughness: 0.3,
                metalness: 0.9
            });
            const shoulderJoint = new THREE.Mesh(shoulderJointGeometry, jointMaterial);
            shoulderJoint.castShadow = true;
            shoulder.add(shoulderJoint);

            const arm1Geometry = new THREE.BoxGeometry(0.3, 3, 0.3);
            const armMaterial = new THREE.MeshStandardMaterial({ 
                color: 0x0088ff,
                roughness: 0.4,
                metalness: 0.7
            });
            const arm1 = new THREE.Mesh(arm1Geometry, armMaterial);
            arm1.position.y = 1.5;
            arm1.castShadow = true;
            shoulder.add(arm1);

            robotArm.add(shoulder);

            // Elbow joint and forearm
            elbow = new THREE.Group();
            elbow.position.y = 3;
            
            const elbowJoint = new THREE.Mesh(shoulderJointGeometry, jointMaterial);
            elbowJoint.castShadow = true;
            elbow.add(elbowJoint);

            const arm2Geometry = new THREE.BoxGeometry(0.25, 2.5, 0.25);
            const arm2 = new THREE.Mesh(arm2Geometry, armMaterial);
            arm2.position.y = 1.25;
            arm2.castShadow = true;
            elbow.add(arm2);

            shoulder.add(elbow);

            // Gripper
            gripper = new THREE.Group();
            gripper.position.y = 2.5;

            const gripperBaseGeometry = new THREE.CylinderGeometry(0.2, 0.2, 0.3, 16);
            const gripperBase = new THREE.Mesh(gripperBaseGeometry, jointMaterial);
            gripperBase.castShadow = true;
            gripper.add(gripperBase);

            // Gripper fingers
            const fingerGeometry = new THREE.BoxGeometry(0.1, 0.6, 0.1);
            const fingerMaterial = new THREE.MeshStandardMaterial({ 
                color: 0x666677,
                roughness: 0.5,
                metalness: 0.8
            });

            gripperLeft = new THREE.Mesh(fingerGeometry, fingerMaterial);
            gripperLeft.position.set(-0.15, -0.3, 0);
            gripperLeft.castShadow = true;
            gripper.add(gripperLeft);

            gripperRight = new THREE.Mesh(fingerGeometry, fingerMaterial);
            gripperRight.position.set(0.15, -0.3, 0);
            gripperRight.castShadow = true;
            gripper.add(gripperRight);

            elbow.add(gripper);

            scene.add(robotArm);
        }

        function animate() {
            requestAnimationFrame(animate);
            
            // Rotate target cube
            targetCube.rotation.y += 0.01;
            
            renderer.render(scene, camera);
        }

        function updateRobotArm() {
            robotArm.rotation.y = THREE.MathUtils.degToRad(armState.joint1);
            shoulder.rotation.z = THREE.MathUtils.degToRad(armState.joint2);
            elbow.rotation.z = THREE.MathUtils.degToRad(armState.joint3);

            if (armState.gripperOpen) {
                gripperLeft.position.x = -0.15;
                gripperRight.position.x = 0.15;
            } else {
                gripperLeft.position.x = -0.05;
                gripperRight.position.x = 0.05;
            }

            updateDisplays();
        }

        function updateDisplays() {
            document.getElementById('value-joint1').textContent = armState.joint1 + '¬∞';
            document.getElementById('value-joint2').textContent = armState.joint2 + '¬∞';
            document.getElementById('value-joint3').textContent = armState.joint3 + '¬∞';
            document.getElementById('display-joint1').textContent = armState.joint1 + '¬∞';
            document.getElementById('display-joint2').textContent = armState.joint2 + '¬∞';
            document.getElementById('display-joint3').textContent = armState.joint3 + '¬∞';
            document.getElementById('display-gripper').textContent = armState.gripperOpen ? 'OPEN' : 'CLOSED';
        }

        // Sliders
        document.getElementById('joint1').addEventListener('input', (e) => {
            if (!isAnimating) {
                armState.joint1 = parseInt(e.target.value);
                updateRobotArm();
                log(`Joint 1 set to ${armState.joint1}¬∞`);
            }
        });

        document.getElementById('joint2').addEventListener('input', (e) => {
            if (!isAnimating) {
                armState.joint2 = parseInt(e.target.value);
                updateRobotArm();
                log(`Joint 2 set to ${armState.joint2}¬∞`);
            }
        });

        document.getElementById('joint3').addEventListener('input', (e) => {
            if (!isAnimating) {
                armState.joint3 = parseInt(e.target.value);
                updateRobotArm();
                log(`Joint 3 set to ${armState.joint3}¬∞`);
            }
        });

        function toggleGripper() {
            armState.gripperOpen = !armState.gripperOpen;
            updateRobotArm();
            log(armState.gripperOpen ? '‚úã Gripper OPENED' : 'ü§è Gripper CLOSED', 'info');
        }

        function resetArm() {
            if (!isAnimating) {
                armState.joint1 = 0;
                armState.joint2 = 0;
                armState.joint3 = 0;
                armState.gripperOpen = true;
                
                document.getElementById('joint1').value = 0;
                document.getElementById('joint2').value = 0;
                document.getElementById('joint3').value = 0;
                
                updateRobotArm();
                log('üîÑ Arm reset to home position', 'warning');
            }
        }

        // Logging
        function log(message, type = 'success') {
            const console = document.getElementById('console');
            const timestamp = new Date().toLocaleTimeString();
            const line = document.createElement('div');
            line.className = `console-line ${type}`;
            line.textContent = `[${timestamp}] ${message}`;
            console.appendChild(line);
            console.scrollTop = console.scrollHeight;
        }

        function clearConsole() {
            document.getElementById('console').innerHTML = '<div class="console-line info">[SYSTEM] Console cleared</div>';
        }

        // Animation helper
        function sleep(ms) {
            return new Promise(resolve => setTimeout(resolve, ms));
        }

        async function animateJoint(joint, target, duration = 1000) {
            isAnimating = true;
            const start = armState[joint];
            const diff = target - start;
            const steps = 30;
            const stepTime = duration / steps;

            for (let i = 0; i <= steps; i++) {
                armState[joint] = Math.round(start + (diff * i / steps));
                document.getElementById(joint).value = armState[joint];
                updateRobotArm();
                await sleep(stepTime);
            }
            isAnimating = false;
        }

        // Sequences
        async function demoSequence() {
            log('üéØ Starting demo sequence...', 'info');
            await animateJoint('joint1', 45, 1000);
            await animateJoint('joint2', 60, 800);
            await animateJoint('joint3', -90, 800);
            await sleep(500);
            await animateJoint('joint3', 0, 800);
            await animateJoint('joint2', 0, 800);
            await animateJoint('joint1', 0, 1000);
            log('‚úÖ Demo complete!', 'success');
        }

        async function pickAndPlace() {
            log('üì¶ Starting pick & place...', 'info');
            await animateJoint('joint1', 60, 1000);
            await animateJoint('joint2', -45, 800);
            await animateJoint('joint3', -75, 800);
            armState.gripperOpen = false;
            updateRobotArm();
            log('ü§è Grabbing object...', 'info');
            await sleep(500);
            await animateJoint('joint2', 30, 800);
            await animateJoint('joint1', -60, 1200);
            await animateJoint('joint2', -30, 800);
            armState.gripperOpen = true;
            updateRobotArm();
            log('‚úã Releasing object', 'info');
            await sleep(300);
            await animateJoint('joint2', 0, 800);
            await animateJoint('joint1', 0, 1000);
            await animateJoint('joint3', 0, 800);
            log('‚úÖ Pick & place complete!', 'success');
        }

        async function waveSequence() {
            log('üëã Waving hello...', 'info');
            await animateJoint('joint2', 70, 600);
            for (let i = 0; i < 3; i++) {
                await animateJoint('joint3', 60, 300);
                await animateJoint('joint3', -60, 300);
            }
            await animateJoint('joint3', 0, 400);
            await animateJoint('joint2', 0, 600);
            log('‚úÖ Wave complete!', 'success');
        }

        async function scanSequence() {
            log('üîç Scanning area...', 'info');
            await animateJoint('joint2', 45, 600);
            await animateJoint('joint1', -90, 2000);
            await animateJoint('joint1', 90, 4000);
            await animateJoint('joint1', 0, 2000);
            await animateJoint('joint2', 0, 600);
            log('‚úÖ Scan complete!', 'success');
        }

        // Handle window resize
        window.addEventListener('resize', () => {
            const canvas = document.getElementById('canvas3d');
            camera.aspect = canvas.clientWidth / canvas.clientHeight;
            camera.updateProjectionMatrix();
            renderer.setSize(canvas.clientWidth, canvas.clientHeight);
        });

        // Initialize
        init3D();
    </script>
</body>
</html>